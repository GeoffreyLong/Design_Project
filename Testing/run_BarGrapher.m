% This script is intended to be a tool in aggregating and visualizing 
%   selected videos and folders.

% So I want as the input is the 
%   folder name, 
%   possibly the videos (probs not though), (could have an agg all flag)
%   Then the attrs I want aggregated over

% Detection metrics (false positives etc) after initial detection over different thresholds
tests = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Video Over Various Thresholds', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSThresh', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northeast');

% Detection metrics (false positives etc) after initial detection over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Video Over Various Thresholds', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSThreshByAttr', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'preTrack', 'legendLoc', 'northeast');

% Per frame detection metrics (false positives etc) after initial detection over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Frame Over Various Thresholds', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionVSThreshPerFrame', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northeast');

% Per frame detection metrics (false positives etc) after initial detection over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Frame Over Various Thresholds', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionVSThreshByAttrPerFrame', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'preTrack', 'legendLoc', 'northeast');


% Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections per Video Over Different Videos', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSVideo', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northwest');

% Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections per Video Over Different Videos', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSVideoByAttr', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'preTrack', 'legendLoc', 'northwest');


% PerFrame Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections per Frame Over Different Videos', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionVSVideoPerFrame', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northeast');

% PerFrame Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections per Frame Over Different Videos', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionVSVideoByAttrPerFrame', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'preTrack', 'legendLoc', 'northwest');



% Detection distances (by frame) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection and detection','First truth detection and 4+ detection string','False Negatives'}}}, ...
    'attrRename', {{{'# frames before 1st detection','# frames before 1st detection string (4+)','False Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'First Detection Distance Over Different Videos', ...
    'yAxisLabel', '', ...
    'saveLocation', '../figures/FirstDetectionFrameVSVideo', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northeast');


% Detection distances (by frame) after initial detection over different thresholds 
tests(end+1) = struct('attributes', {{{'First truth detection and detection','First truth detection and 4+ detection string','False Negatives'}}}, ...
    'attrRename', {{{'# frames before 1st detection','# frames before 1st detection string (4+)','False Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'First Detection Distance Over Different Thresholds', ...
    'yAxisLabel', '', ...
    'saveLocation', '../figures/FirstDetectionFrameVSThresh', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northwest');


% Detection distances (by feet) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection (ft)','First detection (ft)','First 4+ detection string (ft)'}}}, ...
    'attrRename', {{{'Target Distance at First Possible Detection','Target Distance at First Detection','Target Distance at First Detection String (4+)'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'First Detection Distance Over Different Videos', ...
    'yAxisLabel', 'Distance (ft)', ...
    'saveLocation', '../figures/FirstDetectionDistanceVSVideo', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'northeast');

% Detection distances (by feet) after initial detection over different thresholds 
tests(end+1) = struct('attributes', {{{'First truth detection (ft)','First detection (ft)','First 4+ detection string (ft)'}}}, ...
    'attrRename', {{{'Target Distance at First Possible Detection','Target Distance at First Detection','Target Distance at First Detection String (4+)'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'First Detection Distance Over Different Thresholds', ...
    'yAxisLabel', 'Distance (ft)', ...
    'saveLocation', '../figures/FirstDetectionDistanceVSThresh', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'preTrack', 'legendLoc', 'southeast');


%%%%%%% POST TRACKING %%%%%%%
% Detection metrics (false positives etc) after initial detection over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Video Over Various Thresholds (Post Tracking)', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSThreshPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'southeast');

% Detection metrics (false positives etc) after initial detection over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'Detections per Video Over Various Thresholds (Post Tracking)', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSThreshByAttrPostTrack', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'postTrack', 'legendLoc', 'northeast');


% Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections Over Different Videos (Post Tracking)', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSVideoPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'northwest');

% Detection metrics (false positives etc) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'Detections Over Different Videos (Post Tracking)', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionVSVideoByAttrPostTrack', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'postTrack', 'legendLoc', 'northeast');


% Detection distances (by frame) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection and detection','First truth detection and 4+ detection string','False Negatives'}}}, ...
    'attrRename', {{{'# frames before 1st detection','# frames before 1st detection string (4+)','False Negatives'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'First Detection Distance Over Different Videos (Post Tracking)', ...
    'yAxisLabel', '', ...
    'saveLocation', '../figures/FirstDetectionFrameVSVideoPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'northeast');


% Detection distances (by frame) after initial detection over different thresholds 
tests(end+1) = struct('attributes', {{{'First truth detection and detection','First truth detection and 4+ detection string','False Negatives'}}}, ...
    'attrRename', {{{'# frames before 1st detection','# frames before 1st detection string (4+)','False Negatives'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'First Detection Distance Over Different Thresholds (Post Tracking)', ...
    'yAxisLabel', '', ...
    'saveLocation', '../figures/FirstDetectionFrameVSThreshPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'northwest');


% Detection distances (by feet) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection (ft)','First detection (ft)','First 4+ detection string (ft)'}}}, ...
    'attrRename', {{{'Target Distance at First Possible Detection','Target Distance at First Detection','Target Distance at First Detection String (4+)'}}}, ...
    'folders', {{'July 6 cam1 01 Test #1', 'July 8 cam1 02 Test #1', 'July 8 cam1 03 Test #1'}}, ...
    'folderRename', {{'Video #1', 'Video #2', 'video #3'}}, ...
    'plotTitle', 'First Detection Distance Over Different Videos (Post Tracking)', ...
    'yAxisLabel', 'Distance (ft)', ...
    'saveLocation', '../figures/FirstDetectionDistanceVSVideoPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'northeast');

% Detection distances (by feet) after initial detection over different thresholds 
tests(end+1) = struct('attributes', {{{'First truth detection (ft)','First detection (ft)','First 4+ detection string (ft)'}}}, ...
    'attrRename', {{{'Target Distance at First Possible Detection','Target Distance at First Detection','Target Distance at First Detection String (4+)'}}}, ...
    'folders', {{'strel-disk7 thresh-0.08', 'strel-disk7 thresh-0.10', 'strel-disk7 thresh-0.12'}}, ...
    'folderRename', {{'Threshold = 0.08', 'Threshold = 0.10', 'Threshold = 0.12'}}, ...
    'plotTitle', 'First Detection Distance Over Different Thresholds (Post Tracking)', ...
    'yAxisLabel', 'Distance (ft)', ...
    'saveLocation', '../figures/FirstDetectionDistanceVSThreshPostTrack', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'postTrack', 'legendLoc', 'northeast');



%%%%%%% Compare pre and post track %%%%%%%
% Detection metrics (false positives etc) over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'Pre vs Post Tracking Detections', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionPreVsPost', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'all', 'legendLoc', 'northwest');

% Detection metrics (false positives etc) over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'Pre vs Post Tracking Detections', ...
    'yAxisLabel', 'Average Occurences Per Video', ...
    'saveLocation', '../figures/DetectionByAttrPreVsPost', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'all', 'legendLoc', 'northwest');


% PER FRAME Detection metrics (false positives etc) over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'Pre vs Post Tracking Detections', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionPreVsPostPerFrame', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'all', 'legendLoc', 'northwest');

% PER FRAME Detection metrics (false positives etc) over different thresholds
tests(end+1) = struct('attributes', {{{'False Positives (per frame)','False Negatives (per frame)','True Positives (per frame)', 'True Negatives (per frame)'}}}, ...
    'attrRename', {{{'False Positives','False Negatives','True Positives', 'True Negatives'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'Pre vs Post Tracking Detections', ...
    'yAxisLabel', 'Average Occurences Per Frame', ...
    'saveLocation', '../figures/DetectionByAttrPreVsPostPerFrame', ...
    'collapse', 1, 'byAttr', 1, 'stage', 'all', 'legendLoc', 'northwest');


% Detection distances (by frame) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection and detection','First truth detection and 4+ detection string','False Negatives'}}}, ...
    'attrRename', {{{'# frames before 1st detection','# frames before 1st detection string (4+)','False Negatives'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'First Detection Distance', ...
    'yAxisLabel', '', ...
    'saveLocation', '../figures/FirstDetectionFramePreVsPost', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'all', 'legendLoc', 'southeast');


% Detection distances (by feet) after initial detection over different videos
tests(end+1) = struct('attributes', {{{'First truth detection (ft)','First detection (ft)','First 4+ detection string (ft)'}}}, ...
    'attrRename', {{{'Target Distance at First Possible Detection','Target Distance at First Detection','Target Distance at First Detection String (4+)'}}}, ...
    'folders', {{'Pre-Track #1', 'Post-Track #1'}}, ...
    'folderRename', {{'Before Tracking', 'After Tracking'}}, ...
    'plotTitle', 'First Detection Distance', ...
    'yAxisLabel', 'Distance (ft)', ...
    'saveLocation', '../figures/FirstDetectionDistancePreVsPost', ...
    'collapse', 1, 'byAttr', 0, 'stage', 'all', 'legendLoc', 'southeast');




for testIndex = 1:numel(tests)
    test = tests(testIndex);
    bargrapher(test.attributes, test.folders, test.folderRename, ...
        test.plotTitle, test.yAxisLabel, test.collapse, test.saveLocation, ...
        test.attrRename, test.byAttr, test.stage, test.legendLoc)
end